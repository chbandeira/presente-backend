<html xmlns="http://www.w3.org/1999/xhtml"  
    xmlns:h="http://java.sun.com/jsf/html"  
    xmlns:f="http://java.sun.com/jsf/core"  
    xmlns:ui="http://java.sun.com/jsf/facelets"  
    xmlns:p="http://primefaces.org/ui">  
  
<script type="text/javascript">  
	function start() {  
	    PF('statusDialog').show();  
	}  
	  
	function stop() {  
	    PF('statusDialog').hide();  
	}  
</script>    
  
<ui:composition template="../layout/template.xhtml">  
    <ui:define name="corpo">  
		<p:panel header="#{lbl.ocorrenciasImportacao}" closable="true">
			
			<h:form id="frmOcorrencia">
		    
		    <p:messages id="messages" autoUpdate="true" />
		    
		    <p:commandButton 
				value="#{lbl.excluirTodas}"
				icon="ui-icon-trash" 
				onclick="PF('confirmaExcluirTodos').show()"/>
				
				<p:dialog modal="true" widgetVar="statusDialog" header="#{lbl.processando_}" draggable="false" closable="false" resizable="false">  
				    <p:graphicImage library="img" name="ajax_loading_bar.gif" />  
				</p:dialog>  
				  
				<p:commandButton id="downloadLink" value="#{lbl.baixarOcorrencias}" ajax="false" onclick="PrimeFaces.monitorDownload(start, stop)" icon="ui-icon ui-icon-arrowthickstop-1-s">  
				    <p:fileDownload value="#{importacaoMB.file}" />  
				</p:commandButton>  
				
			<!-- CAIXA DE DIALOGO -->
			
			<p:confirmDialog 
				message="#{msg.MSG002}"  
                header="#{lbl.excluirRegistro}" 
                severity="alert" 
                widgetVar="confirmaExcluirTodos">  
		        <p:commandButton 
		        	value="#{lbl.sim}"
		        	actionListener="#{importacaoMB.excluirTodos}" 
		        	ajax="false"
		        	oncomplete="PF('confirmaExcluirTodos').hide()"/>
		        <p:commandButton
		        	value="#{lbl.nao}" 
		        	onclick="PF('confirmaExcluirTodos').hide()" 
		        	type="button" />   
		    </p:confirmDialog> 
				
			<p:separator></p:separator>
		    
			<p:dataTable 
				id="dataTable" 
				var="ocorrencia" 
				value="#{importacaoMB.ocorrencias}" 
				paginator="true" 
				rows="10"
				emptyMessage="#{msg.MSG001}">  
	  
		        <p:column headerText="#{lbl.matricula}">  
		            <h:outputText value="#{ocorrencia.matricula}" />  
		        </p:column>
		        
		        <p:column headerText="#{lbl.nome}">  
		            <h:outputText value="#{ocorrencia.nome}" />  
		        </p:column>
		        
		        <p:column headerText="#{lbl.serie}">  
		            <h:outputText value="#{ocorrencia.serie}" />  
		        </p:column>
		        
		        <p:column headerText="#{lbl.turma}">  
		            <h:outputText value="#{ocorrencia.turma}" />  
		        </p:column>
		        
		        <p:column headerText="#{lbl.turno}">  
		            <h:outputText value="#{ocorrencia.turno}" />  
		        </p:column>
		        
		        <p:column headerText="#{lbl.anoLetivo}">  
		            <h:outputText value="#{ocorrencia.anoLetivo}" />  
		        </p:column>
		        
		        <p:column 
					headerText="#{lbl.opcoes}" 
					style="width: 150px">
					<center>
			            <p:commandButton icon="ui-icon-pencil" title="#{lbl.alterar}" actionListener="#{importacaoMB.alterar}"/>
			            <p:commandButton icon="ui-icon-trash" onclick="PF('confirmaExcluir').show()">
			            	<f:setPropertyActionListener target="#{importacaoMB.ocorrenciaSelecionada}" value="#{ocorrencia}"></f:setPropertyActionListener>
			            </p:commandButton>
		            </center>
		        </p:column>
		        
		        <f:facet name="footer">
		        	<h:outputLabel rendered="#{importacaoMB.ocorrencias.rowCount gt 0}" value="#{importacaoMB.ocorrencias.rowCount}"/>
		        	<h:outputLabel rendered="#{importacaoMB.ocorrencias.rowCount gt 0}" value=" #{msg.MSG041}"/>
		        </f:facet>
		  
		    </p:dataTable>
		    
	    	<!-- CAIXA DE DIALOGO -->
			
			<p:confirmDialog 
				message="#{msg.MSG002}"  
                header="#{lbl.excluirRegistro}" 
                severity="alert" 
                widgetVar="confirmaExcluir">  
		        <p:commandButton 
		        	value="#{lbl.sim}"
		        	actionListener="#{importacaoMB.excluir}" 
		        	ajax="false"
		        	oncomplete="PF('confirmaExcluir').hide()"/>
		        <p:commandButton
		        	value="#{lbl.nao}" 
		        	onclick="PF('confirmaExcluir').hide()" 
		        	type="button" />   
		    </p:confirmDialog> 
		    
			</h:form>
			
	    </p:panel>
    </ui:define>  
</ui:composition>  
</html> 